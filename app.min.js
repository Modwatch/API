/*! modwatchapi 11-03-2015 */
var express=require("express"),bodyParser=require("body-parser"),cookieParser=require("cookie-parser"),methodOverride=require("method-override"),session=require("express-session"),cors=require("cors"),app=express(),http=require("http"),path=require("path"),passport=require("passport"),bcrypt=require("bcrypt-nodejs"),mongoose=require("mongoose/"),configDB=require("./config/db.js").url;mongoose.connect(configDB);var Schema=mongoose.Schema;require("./passport.min.js")(passport);var ipaddress=process.env.OPENSHIFT_NODEJS_IP||"127.0.0.1",port=process.env.OPENSHIFT_NODEJS_PORT||8080,corsOptions={origin:!0,methods:["GET","POST"]};app.set("port",port),app.set("ip",ipaddress),app.set("views",path.join(__dirname,"views")),app.set("view engine","ejs"),app.use(cors()),app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!1})),app.use(methodOverride()),app.use(cookieParser()),app.use(session({secret:process.env.DBEXPRESSSECRET,resave:!1,saveUninitialized:!1})),app.use(passport.initialize()),app.use(passport.session()),app.use(express["static"](path.join(__dirname,"public")));var scriptVersion="0.26b";require("./routes.min.js")(app,cors,corsOptions,scriptVersion),http.createServer(app).listen(app.get("port"),app.get("ip"),function(){console.log("Express server listening at "+app.get("ip")+":"+app.get("port"))});