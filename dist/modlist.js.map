{"version":3,"sources":["modlist.js"],"names":["mongoose","require","bcrypt","Schema","modlistSchema","list","String","modlisttxt","skyrimini","skyrimprefsini","username","password","plugins","modlist","ini","prefsini","skse","enblocal","tag","enb","game","pic","badge","token","timestamp","Date","score","type","Number","default","votedon","upvoted","Boolean","collection","methods","generateHash","_password","hashSync","genSaltSync","validPassword","compareSync","this","shrinkArrays","tempNew","save","i","length","name","push","updateFile","userFile","tempOld","split","substring","votedOnUser","info","index","module","exports","model"],"mappings":"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","file":"modlist.js","sourcesContent":["var mongoose = require(\"mongoose\");\nvar bcrypt = require(\"bcrypt-nodejs\");\n\nvar Schema = mongoose.Schema;\n\nvar modlistSchema = new Schema({\n\tlist: String, // deprecated\n\tmodlisttxt: String, // deprecated\n\tskyrimini: String, // deprecated\n\tskyrimprefsini: String, // deprecated\n\tusername: String,\n\tpassword: String,\n\tplugins: [],\n\tmodlist: [],\n\tini: [],\n\tprefsini: [],\n\tskse: [],\n\tenblocal: [],\n\ttag: String,\n\tenb: String,\n\tgame: String,\n\tpic: String,\n\tbadge: String,\n\ttoken: String,\n\ttimestamp: Date,\n\tscore: {type: Number, default: 0},\n\tvotedon: [{\"username\": String, \"upvoted\": Boolean}]\n}, {\n\tcollection: \"modlist\"\n});\n\nmodlistSchema.methods.generateHash = function(_password) { \"use strict\";\n\treturn bcrypt.hashSync(_password, bcrypt.genSaltSync(8), null);\n};\n\nmodlistSchema.methods.validPassword = function(_password) { \"use strict\";\n\treturn bcrypt.compareSync(_password, this.password);\n};\n\nmodlistSchema.methods.shrinkArrays = function shrinkArrays() { \"use strict\";\n\tvar tempNew = [];\n\tvar save = false;\n\tvar i = 0;\n\n\tif(this.plugins && this.plugins.length > 0 && typeof this.plugins[0].name !== \"undefined\") {\n\t\ttempNew = [];\n\t\tfor(i = 0; i < this.plugins.length; i++) {\n\t\t\ttempNew.push(this.plugins[i].name);\n\t\t}\n\t\tthis.plugins = tempNew;\n\t\tsave = true;\n\t}\n\tif(this.modlist && this.modlist.length > 0 && typeof this.modlist[0].name !== \"undefined\") {\n\t\ttempNew = [];\n\t\tfor(i = 0; i < this.modlist.length; i++) {\n\t\t\ttempNew.push(this.modlist[i].name);\n\t\t}\n\t\tthis.modlist = tempNew;\n\t\tsave = true;\n\t}\n\tif(this.ini && this.ini.length > 0 && typeof this.ini[0].name !== \"undefined\") {\n\t\ttempNew = [];\n\t\tfor(i = 0; i < this.ini.length; i++) {\n\t\t\ttempNew.push(this.ini[i].name);\n\t\t}\n\t\tthis.ini = tempNew;\n\t\tsave = true;\n\t}\n\tif(this.prefsini && this.prefsini.length > 0 && typeof this.prefsini[0].name !== \"undefined\") {\n\t\ttempNew = [];\n\t\tfor(i = 0; i < this.prefsini.length; i++) {\n\t\t\ttempNew.push(this.prefsini[i].name);\n\t\t}\n\t\tthis.prefsini = tempNew;\n\t\tsave = true;\n\t}\n\tif(this.skse && this.skse.length > 0 && typeof this.skse[0].name !== \"undefined\") {\n\t\ttempNew = [];\n\t\tfor(i = 0; i < this.skse.length; i++) {\n\t\t\ttempNew.push(this.skse[i].name);\n\t\t}\n\t\tthis.skse = tempNew;\n\t\tsave = true;\n\t}\n\tif(this.enblocal && this.enblocal.length > 0 && typeof this.enblocal[0].name !== \"undefined\") {\n\t\ttempNew = [];\n\t\tfor(i = 0; i < this.enblocal.length; i++) {\n\t\t\ttempNew.push(this.enblocal[i].name);\n\t\t}\n\t\tthis.enblocal = tempNew;\n\t\tsave = true;\n\t}\n\tif(save) {\n\t\tthis.save();\n\t}\n};\n\nmodlistSchema.methods.updateFile = function updateFile(userFile, type) {\n\t\"use strict\";\n\tvar tempOld = [];\n\tvar tempNew = [];\n\ttempOld = userFile.split(\"\\\",\\\"\");\n\ttempOld[0] = tempOld[0].substring(2);\n\ttempOld[tempOld.length - 1] = tempOld[tempOld.length - 1].substring(0, tempOld[tempOld.length - 1].length - 2);\n\tfor(var i = 0; i < tempOld.length; i++) {\n\t\ttempNew[i] = tempOld[i];\n\t}\n\treturn tempNew;\n};\n\n/**\n *  Scoring Logic\n */\n\nmodlistSchema.methods.votedOnUser = function upvotedUser(username) {\n\t\"use strict\";\n\tvar info = {\n\t\tindex: -1,\n\t\tupvoted: false\n\t};\n\tfor(var i = 0; i < this.votedon.length; i++) {\n\t\tif(this.votedon[i].username === username) {\n\t\t\tinfo.index = i;\n\t\t\tinfo.upvoted = this.votedon[i].upvoted;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn info;\n};\n\nmodule.exports = mongoose.model(\"Modlist\", modlistSchema);\n"],"sourceRoot":"/source/"}